import pandas as pd

# assuming the data is in a csv file named 'travel.csv' with the first row as column names
df = pd.read_csv('travel.csv')

# create combined column
df['Type_Transaction'] = df['Travel Type'].str.upper() + '_' + df['Transaction'].str.upper()

# group by PNR, Type_Transaction and Book Country, count occurrences, then group by Book Country
grouped = df.groupby(['PNR', 'Type_Transaction', 'Book Country']).size().groupby('Book Country').agg(list)

# transform the grouped Series object into a DataFrame
grouped_df = grouped.reset_index(name='counts')
grouped_df = grouped_df.rename_axis(None, axis=1)  # remove the index name

# convert each item in each list to tuple
result = grouped_df['counts'].apply(lambda x: [tuple(x)]).explode().reset_index(name='combinations')

# add counts column by getting the length of each tuple in combinations column
result['count'] = result['combinations'].apply(lambda x: len(x))

print(result)

import pandas as pd

# assuming the data is in a csv file named 'travel.csv' with the first row as column names
df = pd.read_csv('travel.csv')

# create combined column
df['Type_Transaction'] = df['Travel Type'].str.upper() + '_' + df['Transaction'].str.upper()

# group by PNR, Type_Transaction and Book Country, count occurrences, then group by Book Country
grouped = df.groupby(['PNR', 'Type_Transaction', 'Book Country']).size().groupby('Book Country').agg(list)

# transform the grouped Series object into a DataFrame
grouped_df = grouped.reset_index(name='counts')
grouped_df = grouped_df.rename_axis(None, axis=1)  # remove the index name

# convert each item in each list to tuple and rename column
result = grouped_df['counts'].apply(lambda x: tuple(x)).reset_index(name='combinations')

# add counts column by getting the length of each tuple in combinations column
result['count'] = result['combinations'].apply(lambda x: len(x))

print(result)

import pandas as pd

# assuming the data is in a csv file named 'travel.csv' with the first row as column names
df = pd.read_csv('travel.csv')

# Convert Travel Type and Transaction to string
df['Travel Type'] = df['Travel Type'].astype('str')
df['Transaction'] = df['Transaction'].astype('str')

# create a new column with tuples of Travel Type and Transaction
df['combination'] = df[['Travel Type', 'Transaction']].apply(lambda row: (row[0], row[1]), axis=1)

# group by PNR and create sorted list of tuples
df_grouped = df.groupby('PNR').agg(lambda x: sorted(x)).reset_index()

# group by Book Country and count occurrences of each list of tuples
result_df = df_grouped.groupby('Book Country').agg(list).reset_index(name='List of Tuples')
result_df['count'] = result_df['List of Tuples'].apply(lambda x: len(x))

print(result_df)

